@using System
@using DarkDescent.Actor
@using Sandbox
@using Sandbox.UI
@using DarkDescent.GameLog.UI

@attribute [StyleSheet]

@namespace DarkDescent.UI
@inherits PanelComponent

<root>
    <Crosshair/>
    <GameLogPanel/>
    
    @if ( LocalActor is not null )
    {
	    <ResourceBar class="exp-bar exp" Maximum=@LocalActor.ExperienceRequirement Minimum=@(0) Current=@LocalActor.Experience />
	    <ResourceBar class="gothic-style health-bar health" Maximum=@LocalActor.Stats.MaxHealth Minimum=@(0) Current=@LocalActor.Health />
	    <ResourceBar class="gothic-style stamina-bar stamina" Maximum=@LocalActor.Stats.MaxStamina Minimum=@(0) Current=@LocalActor.Stamina />
    }
</root>

@code
{
	[Property] public GameObject Actor { get; set; }
	
	public ActorComponent LocalActor => Actor.Components.Get<ActorComponent>();
	
	//not amazed by this prospect.
	//full rebuild of the HUD every time a stat changes is :s
	protected override int BuildHash()
	{
		if ( LocalActor is null )
			return base.BuildHash();
		
		return HashCode.Combine( LocalActor.Stats.MaxHealth, LocalActor.Health, LocalActor.Stats.MaxStamina, LocalActor.Stamina, LocalActor.Experience, LocalActor.ExperienceRequirement);
	}
}
